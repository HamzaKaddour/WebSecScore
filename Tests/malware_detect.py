# if detected as Malware or not
import requests

def checkMalwareURL(domain):
    result = {
        "isMalware" : 0,
        "info" : None
    }
    url = "https://urlhaus-api.abuse.ch/v1/url/"
    post_data = {
    "url": domain
    }
    
    try:
        response = requests.post(url, data=post_data)
        if response.status_code == 200:
            response_json = response.json()
            if response_json["query_status"] == "no_results":
                return result
            elif response_json["query_status"] == "ok":
                result["isMalware"] = 1
                info_extracted = ["url_status", "host", "date_added", "threat", "blacklists", "reporter", "takedown_time_seconds", "payloads"]
                result["info"] = {key: response_json[key] for key in info_extracted if key in response_json}
            else:
                result["info"] = "This is not a valid URL"
        else:
            result["info"] = "invalid response code"
    except Exception as e:
        print(e)
    finally:
        return result
            
                	
print(checkMalwareURL("http://sskymedia.com/VMYB-ht_JAQo-gi/INV/99401FORPO/20673114777/US/Outstanding-Invoices/"))